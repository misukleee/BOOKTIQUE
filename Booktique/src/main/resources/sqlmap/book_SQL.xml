<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.op.booktique.mapper.book.BookMapper">
    
    <resultMap type="bookVO" id="BookVOMap">
        <result property="bookId" column="BOOK_ID"/>
        <result property="categoryId" column="CATEGORY_ID"/>
        <result property="bookTitle" column="BOOK_TITLE"/>
        <result property="isbn" column="ISBN"/>
        <result property="bookPrice" column="BOOK_PRICE"/>
        <result property="discountRate" column="DISCOUNT_RATE"/>
        <result property="author" column="AUTHOR"/>
        <result property="publisher" column="PUBLISHER"/>
        <result property="bookSize" column="BOOK_SIZE"/>
        <result property="bookPage" column="BOOK_PAGE"/>
        <result property="bookDate" column="BOOK_DATE"/>
        <result property="bookExplan" column="BOOK_EXPLAN"/>
        <result property="bookImg" column="BOOK_IMG"/>
        <result property="bookSub" column="BOOK_SUB"/>
    </resultMap>
    
    <resultMap type="categoryVO" id="CategoryVOMap">
    	<result property="categoryId" column="CATEGORY_ID"/>
		<result property="categoryName" column="CATEGORY_NAME"/>
		<result property="parentId" column="PARENT_ID"/>
    </resultMap>
    
    <!-- 책 데이터를 삽입하는 쿼리 -->
    <insert id="insertBook" parameterType="bookVO">
        INSERT INTO BOOK (
            BOOK_ID,
            CATEGORY_ID,
            BOOK_TITLE,
            ISBN,
            BOOK_PRICE,
            DISCOUNT_RATE,
            AUTHOR,
            PUBLISHER,
            BOOK_SIZE,
            BOOK_PAGE,
            BOOK_DATE,
            BOOK_EXPLAN,
            BOOK_IMG,
            BOOK_SUB
        )
        VALUES (
            #{bookId},
            #{categoryId},
            #{bookTitle},
            #{isbn},
            #{bookPrice},
            #{discountRate},
            #{author},
            #{publisher},
            #{bookSize},
            #{bookPage},
            #{bookDate},
            #{bookExplan},
            #{bookImg},
            #{bookSub}
        )
    </insert>
    
    <!-- 모든 책 데이터를 삭제하는 쿼리 -->
    <delete id="deleteAllBooks">
        DELETE FROM BOOK
    </delete>

    <!-- 모든 카테고리 데이터를 삭제하는 쿼리 -->
    <delete id="deleteAllCategories">
        DELETE FROM CATEGORY
    </delete>
    
    <!-- 카테고리 코드를 가져오는 쿼리 -->
    <select id="getCategoryCodes" resultType="string">
        SELECT category_id FROM CATEGORY
    </select>

    <!-- 전체 책 수를 가져오는 쿼리 (페이징 처리를 위한 총 아이템 수 계산) -->
    <select id="countBooks" resultType="int">
        SELECT COUNT(*) FROM BOOK
    </select>

    <!-- 페이징을 위해 책 리스트를 가져오는 쿼리 -->
	<select id="getBooks" resultType="com.op.booktique.vo.book.BookVO">
	    SELECT * FROM BOOK
	    ORDER BY #{bookId}
	</select>

</mapper>